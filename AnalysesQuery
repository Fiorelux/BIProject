SET LINESIZE 2000;

SELECT TRADER, 
      SUM(ORDERSIZE) AS "TOTAL ORDERSIZE PER TRADER", 
      COUNT(ORDERSIZE) AS "NUMBER OF ORDERs PER TRADER", 
      ROUND(AVG(ORDERSIZE),0) AS "AVERAGE ORDERSIZE"    
	FROM MKTORDER
  GROUP BY TRADER
  ORDER BY SUM(ORDERSIZE) ASC;
 
SELECT TO_CHAR(mkt.ORDERTIME, 'HH24:MI:SS')
FROM MKTORDER mkt;

SELECT cmp.TICKER,
      SUM(mkt.ORDERSIZE) AS "TOTAL ORDERSIZE PER COMPANY",
      COUNT(mkt.ORDERSIZE) AS "NUMBER OF ORDERs PER COMPANY"
      FROM MKTORDER mkt, COMPANY cmp
      WHERE cmp.TICKER = mkt.TICKER
      GROUP BY cmp.TICKER;
      


SET LINESIZE 2000;

SELECT TRADER, 
      SUM(ORDERSIZE) AS "TOTAL ORDERSIZE PER TRADER", 
      COUNT(ORDERSIZE) AS "NUMBER OF ORDERs PER TRADER", 
      ROUND(AVG(ORDERSIZE),0) AS "AVERAGE ORDERSIZE"    
	FROM MKTORDER
  GROUP BY TRADER
  ORDER BY SUM(ORDERSIZE) ASC;
 
SELECT TO_CHAR(mkt.ORDERTIME, 'HH24:MI:SS')
FROM MKTORDER mkt;

SELECT cmp.TICKER,
		SUM(mkt.ORDERSIZE) AS "TOTAL ORDERSIZE PER COMPANY",
		COUNT(mkt.ORDERSIZE) AS "NUMBER OF ORDERs PER COMPANY",
		AVG(mkt.ORDERSIZE) AS "AVERAGE ORDERSIZE PER COMP"
	FROM MKTORDER mkt, COMPANY cmp
    WHERE cmp.TICKER = mkt.TICKER
    GROUP BY cmp.TICKER;
	  

SELECT cmp.COMMONNAME,
		AVG(mkt.Price) AS "avg price for buy",
		AVG(mkt2.Price) AS "avg price for sell"
	FROM MKTORDER mkt, COMPANY cmp
	WHERE mkt.BS = B
	GROUP BY cmp.COMMONNAME
	HAVING cmp.Ticker = mkt.TICKER;

SELECT mkt.TRADER AS "Trader",
		COUNT(mkt.Ticker) AS "Company"
	FROM MKTORDER mkt
	GROUP BY mkt.TRADER;
	
SELECT cmp.Sector,
		AVG(mkt.OrderSize) AS "avg order size per parentsector",
	FROM COMPANY cmp, MKTORDER mkt
	WHERE cmp.Ticker = mkt.Ticker
	GROUP BY x.ParentSTR;
	
